name: Switch DNS
this: 09_switch_dns
type: sqs
retry_delay: 120
data:
  domain: cmil2mssslzz.ap-southeast-2.rds.amazonaws.com
  instance_class: DBInstanceClassR6i
  instance_type: 8xlarge
  mysql_version: 8.0.32
  params_id: '1'
  schema: Turkey_BLU
  snapshot_arn: arn:aws:rds:ap-southeast-2:561082505378:snapshot:tst-anstead-12-bua-sql-mysql8-0-32
  suffix: bua-sql
  update_id: '12'
  rdssecret: "cicd/tst-anstead/rds/bua"
  hosted_zone_id: "Z06477101FOH3N8B2WK6N"
steps:
  09_switch_dns:
    comment: need to update route53 entries with the rds server endpoint
    action: set_rds_dns_entry
    args:
      route53_records:
        - name: tst-sql1.anstead.encore.sh
          type: CNAME
    'on':
      COMPLETE: {}
